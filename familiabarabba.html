<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Barabba Rocha - Controle Financeiro Familiar</title>
    <style>
        :root {
            --primary-color: #6C63FF;
            --primary-light: rgba(108, 99, 255, 0.15);
            --secondary-color: #1CC8EE;
            --secondary-light: rgba(28, 200, 238, 0.15);
            --accent-color: #FF4FC1;
            --text-color: #1F2937;
            --light-text: #94A3B8;
            --success-color: #00C49F;
            --warning-color: #FFB347;
            --danger-color: #FF4C61;
            --border-color: #E2E8F0;
            --card-bg: #FFFFFF;
            --hover-bg: #F1F5F9;
            --radius: 12px;
            --shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
            --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
        }

        body {
            background-color: #F8FAFC;
            color: var(--text-color);
            min-height: 100vh;
            line-height: 1.5;
        }

        /* --- Tela de Login --- */
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, var(--primary-color) 0%, #8A63FF 100%);
        }

        .login-card {
            background: var(--card-bg);
            border-radius: var(--radius);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            padding: 40px;
            width: 100%;
            max-width: 400px;
            text-align: center;
            transition: var(--transition);
        }

        .login-logo {
            width: 140px;
            height: 140px;
            margin-bottom: 25px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid var(--secondary-color);
            box-shadow: var(--shadow);
            background-color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            font-weight: bold;
            color: var(--primary-color);
            margin: 0 auto 25px;
        }

        .login-card h1 {
            font-size: 1.8rem;
            margin-bottom: 25px;
            color: var(--primary-color);
            font-weight: 600;
        }

        .input-group {
            position: relative;
            margin-bottom: 20px;
        }

        .input-group i {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--light-text);
        }

        .login-card input {
            width: 100%;
            padding: 12px 15px 12px 40px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-size: 15px;
            transition: var(--transition);
        }

        .login-card input:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px var(--primary-light);
            outline: none;
        }

        .btn-login {
            width: 100%;
            padding: 14px;
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 500;
            font-size: 16px;
            cursor: pointer;
            transition: var(--transition);
            margin-top: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .btn-login:hover {
            background: #5A52E0;
            transform: translateY(-1px);
        }

        .btn-login:active {
            transform: translateY(0);
        }

        .login-links {
            margin-top: 25px;
            font-size: 14px;
            color: var(--light-text);
        }

        .login-links a {
            color: var(--primary-color);
            text-decoration: none;
            font-weight: 500;
            transition: var(--transition);
        }

        .login-links a:hover {
            color: #5A52E0;
            text-decoration: underline;
        }

        /* --- Container Principal (ap√≥s login) --- */
        .container {
            display: none;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            animation: fadeIn 0.5s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px 0;
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
        }

        .header-logo {
            height: 80px;
            width: 80px;
            margin-bottom: 15px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid var(--secondary-color);
            box-shadow: var(--shadow);
            background-color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--primary-color);
            margin: 0 auto 15px;
        }

        .header h1 {
            font-size: 2.2rem;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--primary-color);
            background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            display: inline-block;
        }

        .header p {
            font-size: 1.1rem;
            color: var(--light-text);
            max-width: 600px;
            margin: 0 auto;
        }

        /* --- Tabs Navigation --- */
        .tabs {
            display: flex;
            background: var(--card-bg);
            border-radius: var(--radius) var(--radius) 0 0;
            box-shadow: var(--shadow);
            overflow: hidden;
            margin-bottom: 2px;
        }

        .tab {
            flex: 1;
            padding: 16px 20px;
            text-align: center;
            cursor: pointer;
            background: transparent;
            border: none;
            font-weight: 500;
            font-size: 15px;
            color: var(--light-text);
            transition: var(--transition);
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .tab.active {
            color: var(--primary-color);
            font-weight: 500;
        }

        .tab.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background-color: var(--primary-color);
            border-radius: 3px 3px 0 0;
        }

        .tab:hover:not(.active) {
            background-color: var(--hover-bg);
        }

        /* --- Page Content --- */
        .page {
            display: none;
            background: var(--card-bg);
            border-radius: 0 0 var(--radius) var(--radius);
            box-shadow: var(--shadow);
            padding: 30px;
            min-height: 500px;
        }

        .page.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        h2 {
            font-size: 1.8rem;
            font-weight: 600;
            margin-bottom: 25px;
            color: var(--text-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* --- Dashboard Styles --- */
        .dashboard-actions {
            margin: 20px 0;
            text-align: right;
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .summary-card {
            background: var(--card-bg);
            padding: 25px;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            transition: var(--transition);
            border-left: 4px solid var(--primary-color);
            display: flex;
            flex-direction: column;
        }

        .summary-card:nth-child(2) {
            border-left-color: var(--secondary-color);
        }

        .summary-card:nth-child(3) {
            border-left-color: var(--success-color);
        }

        .summary-card:nth-child(4) {
            border-left-color: var(--accent-color);
        }

        .summary-card h3 {
            font-size: 1em;
            margin-bottom: 10px;
            color: var(--light-text);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .summary-card .value {
            font-size: 2.2em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .summary-card .sub-value {
            font-size: 0.9em;
            color: var(--light-text);
            margin-top: auto;
        }

        .goal-progress {
            height: 8px;
            background-color: var(--border-color);
            border-radius: 4px;
            margin-top: 8px;
            overflow: hidden;
        }
        
        .goal-progress-bar {
            height: 100%;
            background-color: var(--success-color);
            transition: width 0.3s ease;
        }

        .charts-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .chart-container {
            position: relative;
            height: 300px;
            width: 100%;
            background: var(--card-bg);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            padding: 20px;
        }

        .chart-container.full-width {
            grid-column: span 2;
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .chart-header h3 {
            font-size: 1.2rem;
            font-weight: 500;
            color: var(--text-color);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* --- Form Styles --- */
        .add-expense {
            background: var(--card-bg);
            padding: 20px;
            border-radius: var(--radius);
            margin-bottom: 25px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            border: 1px solid var(--border-color);
        }

        .add-expense h3 {
            font-size: 1.2rem;
            font-weight: 500;
            margin-bottom: 18px;
            color: var(--text-color);
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }

        .input-group {
            display: flex;
            flex-direction: column;
        }

        .input-group label {
            font-size: 14px;
            margin-bottom: 6px;
            color: var(--light-text);
            display: flex;
            align-items: center;
        }

        input[type="number"], 
        input[type="text"], 
        input[type="date"], 
        select {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-size: 15px;
            transition: var(--transition);
            background-color: var(--card-bg);
            color: var(--text-color);
        }

        input[type="number"]:focus, 
        input[type="text"]:focus, 
        input[type="date"]:focus, 
        select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px var(--primary-light);
        }

        /* --- Button Styles --- */
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 980px;
            cursor: pointer;
            font-weight: 500;
            font-size: 15px;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }

        .btn-secondary {
            background-color: var(--secondary-color);
            color: white;
        }

        .btn-danger {
            background-color: var(--danger-color);
            color: white;
        }

        .btn-success {
            background-color: var(--success-color);
            color: white;
        }

        .btn-outline {
            background-color: transparent;
            border: 1px solid var(--border-color);
            color: var(--text-color);
        }

        .btn:hover {
            opacity: 0.85;
            transform: translateY(-1px);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-sm {
            padding: 8px 12px;
            font-size: 14px;
        }

        /* --- Table Styles --- */
        .table-container {
            overflow-x: auto;
            margin-bottom: 25px;
            border-radius: var(--radius);
            border: 1px solid var(--border-color);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: var(--card-bg);
        }

        th, td {
            padding: 16px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }

        th {
            font-weight: 500;
            font-size: 14px;
            color: var(--light-text);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            background-color: var(--hover-bg);
        }

        tr:last-child td {
            border-bottom: none;
        }

        tr:hover {
            background-color: var(--hover-bg);
        }

        .actions-cell {
            display: flex;
            gap: 8px;
        }

        .total-row {
            background-color: var(--hover-bg);
            font-weight: 500;
        }

        /* --- Status Badges --- */
        .status-badge {
            padding: 6px 12px;
            border-radius: 50px;
            font-size: 13px;
            font-weight: 500;
            display: inline-block;
        }

        .status-em-andamento {
            background-color: rgba(255, 179, 71, 0.1);
            color: var(--warning-color);
        }

        .status-concluido {
            background-color: rgba(0, 196, 159, 0.1);
            color: var(--success-color);
        }

        /* --- Empty State --- */
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: var(--light-text);
        }

        .empty-state i {
            font-size: 40px;
            margin-bottom: 15px;
            opacity: 0.5;
            color: var(--secondary-color);
        }

        .empty-state p {
            font-size: 16px;
        }

        /* --- Tooltips --- */
        .info-tooltip {
            position: relative;
            display: inline-block;
            margin-left: 8px;
            cursor: help;
        }

        .info-tooltip .tooltip-text {
            visibility: hidden;
            width: 200px;
            background-color: var(--text-color);
            color: var(--card-bg);
            text-align: center;
            border-radius: 6px;
            padding: 8px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.9rem;
            font-weight: normal;
        }

        .info-tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }

        /* --- Responsive Styles --- */
        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .tabs {
                flex-wrap: wrap;
            }
            
            .tab {
                flex: 1 0 50%;
                padding: 12px;
                font-size: 14px;
            }
            
            .page {
                padding: 20px;
            }
            
            .btn {
                padding: 10px 16px;
                font-size: 14px;
            }
            
            th, td {
                padding: 12px;
            }
            
            .dashboard-grid {
                grid-template-columns: 1fr;
            }

            .login-card {
                padding: 30px 20px;
                margin: 0 20px;
            }
            
            .header h1 {
                font-size: 1.8rem;
            }

            .charts-container {
                grid-template-columns: 1fr;
            }

            .chart-container.full-width {
                grid-column: span 1;
            }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <!-- Tela de Login -->
    <div class="login-container" id="loginPage">
        <div class="login-card">
            <div class="login-logo">BR</div>
            <h1>Controle Financeiro Familiar</h1>
            <div class="input-group">
                <i class="fas fa-envelope"></i>
                <input type="email" id="loginEmail" placeholder="E-mail" required>
            </div>
            <div class="input-group">
                <i class="fas fa-lock"></i>
                <input type="password" id="loginPassword" placeholder="Senha" required>
            </div>
            <button class="btn-login" onclick="login()">
                <i class="fas fa-sign-in-alt" style="margin-right: 8px;"></i> Entrar
            </button>
            <div class="login-links">
                <a href="#" onclick="showForgotPassword()">Esqueceu a senha?</a>
            </div>
        </div>
    </div>

    <!-- Sistema Financeiro (ap√≥s login) -->
    <div class="container" id="appContainer">
        <div class="header">
            <div class="header-logo">BR</div>
            <h1>Controle Financeiro Familiar</h1>
            <p>Bem-vindo, <span id="userName" style="color: var(--primary-color); font-weight: 500;">Fam√≠lia Barabba Rocha</span></p>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="showPage('dashboard')"><i class="fas fa-chart-line"></i> Dashboard</button>
            <button class="tab" onclick="showPage('data-entry')"><i class="fas fa-pen-to-square"></i> Preencher Dados</button>
            <button class="tab" onclick="showPage('fixas')"><i class="fas fa-home"></i> Fixas</button>
            <button class="tab" onclick="showPage('metas')"><i class="fas fa-bullseye"></i> Metas</button>
            <button class="tab" onclick="showPage('investimentos')"><i class="fas fa-chart-pie"></i> Investimentos</button>
            <button class="tab" onclick="showPage('alertas')"><i class="fas fa-bell"></i> Alertas</button>
        </div>

        <!-- P√ÅGINA DO DASHBOARD -->
        <div id="dashboard" class="page active">
            <div class="dashboard-actions">
                <button class="btn btn-outline" onclick="exportToPDF()">
                    <i class="fas fa-file-pdf"></i> Exportar PDF
                </button>
                <button class="btn btn-outline" onclick="exportToExcel()">
                    <i class="fas fa-file-excel"></i> Exportar Excel
                </button>
                <button class="btn btn-primary" onclick="showPage('data-entry')">
                    <i class="fas fa-plus"></i> Adicionar Dados
                </button>
            </div>

            <div class="dashboard-grid">
                <div class="summary-card">
                    <h3><i class="fas fa-money-bill-wave"></i> Renda Mensal</h3>
                    <div class="value">R$ <span id="renda-mensal">0</span></div>
                    <div class="sub-value"><span id="renda-principal-valor">R$ 0</span> (principal) + <span id="renda-extra-valor">R$ 0</span> (extra)</div>
                </div>
                
                <div class="summary-card">
                    <h3><i class="fas fa-home"></i> Despesas Fixas</h3>
                    <div class="value">R$ <span id="despesas-fixas-total">0</span></div>
                    <div class="sub-value"><span id="despesas-categorias">0</span> categorias</div>
                </div>
                
                <div class="summary-card">
                    <h3><i class="fas fa-piggy-bank"></i> Reserva Financeira</h3>
                    <div class="value">R$ <span id="reserva-total">0</span></div>
                    <div class="sub-value"><span id="reserva-meses">0</span> meses de seguran√ßa</div>
                </div>
                
                <div class="summary-card">
                    <h3><i class="fas fa-wallet"></i> Saldo Dispon√≠vel</h3>
                    <div class="value" id="saldo-mensal">R$ 0</div>
                    <div class="sub-value" id="saldo-status">Status: <span>Normal</span></div>
                </div>
            </div>

            <div class="charts-container">
                <div class="chart-container">
                    <div class="chart-header">
                        <h3><i class="fas fa-chart-pie"></i> Distribui√ß√£o de Gastos</h3>
                        <select id="gastos-periodo" onchange="updateCharts()">
                            <option value="mensal">Mensal</option>
                            <option value="anual">Anual</option>
                        </select>
                    </div>
                    <canvas id="gastosChart"></canvas>
                </div>

                <div class="chart-container">
                    <div class="chart-header">
                        <h3><i class="fas fa-bullseye"></i> Progresso das Metas</h3>
                        <button class="btn btn-outline btn-sm" onclick="showPage('metas')">
                            <i class="fas fa-plus"></i> Adicionar
                        </button>
                    </div>
                    <canvas id="metasChart"></canvas>
                </div>

                <div class="chart-container full-width">
                    <div class="chart-header">
                        <h3><i class="fas fa-chart-line"></i> Evolu√ß√£o Financeira (6 meses)</h3>
                        <div class="btn-group">
                            <button class="btn btn-outline btn-sm active" data-period="6">6M</button>
                            <button class="btn btn-outline btn-sm" data-period="12">1A</button>
                            <button class="btn btn-outline btn-sm" data-period="24">2A</button>
                        </div>
                    </div>
                    <canvas id="evolucaoChart"></canvas>
                </div>

                <div class="chart-container">
                    <div class="chart-header">
                        <h3><i class="fas fa-globe"></i> Aloca√ß√£o de Investimentos</h3>
                        <button class="btn btn-outline btn-sm" onclick="showPage('investimentos')">
                            <i class="fas fa-plus"></i> Adicionar
                        </button>
                    </div>
                    <canvas id="alocacaoChart"></canvas>
                </div>

                <div class="chart-container">
                    <div class="chart-header">
                        <h3><i class="fas fa-chart-bar"></i> Tipos de Investimento</h3>
                        <select id="investimentos-filtro" onchange="updateCharts()">
                            <option value="todos">Todos</option>
                            <option value="renda-variavel">Renda Vari√°vel</option>
                            <option value="renda-fixa">Renda Fixa</option>
                        </select>
                    </div>
                    <canvas id="investimentosChart"></canvas>
                </div>
            </div>

            <div class="dashboard-grid" style="margin-top: 20px;">
                <div class="summary-card">
                    <h3><i class="fas fa-chart-pie"></i> Patrim√¥nio Total</h3>
                    <div class="value">R$ <span id="patrimonio-total">0</span></div>
                    <div class="sub-value"><span id="patrimonio-investimentos">R$ 0</span> investidos</div>
                </div>
                
                <div class="summary-card">
                    <h3><i class="fas fa-calendar"></i> Pr√≥ximas Despesas</h3>
                    <div class="value"><span id="proximas-despesas">0</span></div>
                    <div class="sub-value">Vencendo em 7 dias</div>
                </div>
                
                <div class="summary-card">
                    <h3><i class="fas fa-bell"></i> Alertas</h3>
                    <div class="value"><span id="alertas-pendentes">0</span></div>
                    <div class="sub-value">Para revis√£o</div>
                </div>
                
                <div class="summary-card">
                    <h3><i class="fasfa-lightbulb"></i> Dica do Dia</h3>
                    <div class="value" style="font-size: 1.2rem;" id="dica-do-dia">Economize 10% da renda</div>
                    <div class="sub-value"><a href="#" onclick="mostrarOutraDica()">Mostrar outra</a></div>
                </div>
            </div>
        </div>

        <!-- P√ÅGINA DE PREENCHIMENTO DE DADOS -->
        <div id="data-entry" class="page">
            <h2><i class="fas fa-pen-to-square"></i> Preencher Dados Financeiros</h2>
            
            <div class="section">
                <h3 class="section-title"><i class="fas fa-money-bill-wave"></i> Renda Mensal</h3>
                <div class="form-row">
                    <div class="input-group">
                        <label for="renda-principal">Renda Principal
                            <div class="info-tooltip">
                                <i class="fas fa-info-circle"></i>
                                <span class="tooltip-text">Valor l√≠quido recebido no seu trabalho principal</span>
                            </div>
                        </label>
                        <input type="number" id="renda-principal" placeholder="Ex: 3500.00" step="0.01">
                    </div>
                    
                    <div class="input-group">
                        <label for="renda-extra">Renda Extra
                            <div class="info-tooltip">
                                <i class="fas fa-info-circle"></i>
                                <span class="tooltip-text">Freelas, bicos ou outras fontes de renda</span>
                            </div>
                        </label>
                        <input type="number" id="renda-extra" placeholder="Ex: 500.00" step="0.01">
                    </div>
                </div>
            </div>

            <div class="section">
                <h3 class="section-title"><i class="fas fa-home"></i> Despesas Fixas</h3>
                <div class="form-row">
                    <div class="input-group">
                        <label for="despesa-aluguel">Aluguel/Moradia</label>
                        <input type="number" id="despesa-aluguel" placeholder="Ex: 1200.00" step="0.01">
                    </div>
                    
                    <div class="input-group">
                        <label for="despesa-alimentacao">Alimenta√ß√£o</label>
                        <input type="number" id="despesa-alimentacao" placeholder="Ex: 800.00" step="0.01">
                    </div>
                    
                    <div class="input-group">
                        <label for="despesa-transporte">Transporte</label>
                        <input type="number" id="despesa-transporte" placeholder="Ex: 300.00" step="0.01">
                    </div>
                    
                    <div class="input-group">
                        <label for="despesa-educacao">Educa√ß√£o</label>
                        <input type="number" id="despesa-educacao" placeholder="Ex: 400.00" step="0.01">
                    </div>
                </div>
            </div>

            <div class="section">
                <h3 class="section-title"><i class="fas fa-bullseye"></i> Metas Financeiras</h3>
                <div class="form-row">
                    <div class="input-group">
                        <label for="meta-reserva">Reserva de Emerg√™ncia</label>
                        <input type="number" id="meta-reserva" placeholder="Valor alvo (R$)" step="0.01">
                    </div>
                    
                    <div class="input-group">
                        <label for="meta-viagem">Viagem</label>
                        <input type="number" id="meta-viagem" placeholder="Valor alvo (R$)" step="0.01">
                    </div>
                    
                    <div class="input-group">
                        <label for="meta-outra">Outra Meta</label>
                        <input type="text" id="meta-outra-nome" placeholder="Nome da meta">
                        <input type="number" id="meta-outra-valor" placeholder="Valor alvo (R$)" step="0.01" style="margin-top: 8px;">
                    </div>
                </div>
            </div>

            <div class="form-actions" style="margin-top: 30px;">
                <button class="btn btn-primary" onclick="saveData()">
                    <i class="fas fa-save"></i> Salvar Dados
                </button>
                <button class="btn btn-outline" onclick="showPage('dashboard')">
                    <i class="fas fa-arrow-left"></i> Voltar ao Dashboard
                </button>
            </div>
        </div>

        <!-- P√ÅGINA DE DESPESAS FIXAS -->
        <div id="fixas" class="page">
            <h2><i class="fas fa-home"></i> Despesas Fixas Mensais</h2>
            
            <div class="add-expense">
                <h3>Adicionar Despesa Fixa</h3>
                <div class="form-row">
                    <input type="text" id="fixa-categoria" placeholder="Categoria (ex: Aluguel)" required>
                    <input type="number" id="fixa-valor" placeholder="Valor (R$)" step="0.01" required>
                    <select id="fixa-tipo">
                        <option value="">Tipo de despesa</option>
                        <option value="Moradia">Moradia</option>
                        <option value="Transporte">Transporte</option>
                        <option value="Alimenta√ß√£o">Alimenta√ß√£o</option>
                        <option value="Educa√ß√£o">Educa√ß√£o</option>
                        <option value="Lazer">Lazer</option>
                        <option value="Outros">Outros</option>
                    </select>
                    <button class="btn btn-success" onclick="addFixedExpense()"><i class="fas fa-plus"></i> Adicionar</button>
                </div>
                <div class="form-row">
                    <input type="text" id="fixa-observacao" placeholder="Observa√ß√£o (opcional)">
                </div>
            </div>

            <div class="table-container">
                <table id="despesas-fixas-table">
                    <thead>
                        <tr>
                            <th>Categoria</th>
                            <th>Tipo</th>
                            <th>Valor (R$)</th>
                            <th>Observa√ß√£o</th>
                            <th>A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody id="despesas-fixas-tbody">
                        <!-- Dados ser√£o inseridos via JavaScript -->
                    </tbody>
                </table>
            </div>
            
            <div id="fixas-empty" class="empty-state" style="display: none;">
                <i class="fas fa-home"></i>
                <p>Nenhuma despesa fixa cadastrada ainda</p>
                <button class="btn btn-outline" onclick="document.getElementById('fixa-categoria').focus()">
                    <i class="fas fa-plus"></i> Adicionar sua primeira despesa
                </button>
            </div>
        </div>

        <!-- P√ÅGINA DE METAS -->
        <div id="metas" class="page">
            <h2><i class="fas fa-bullseye"></i> Planejamento de Reservas e Metas</h2>
            
            <div class="add-expense">
                <h3>Adicionar Nova Meta</h3>
                <div class="form-row">
                    <input type="text" id="meta-nome" placeholder="Nome da Meta" required>
                    <input type="number" id="meta-valor" placeholder="Valor Alvo (R$)" step="0.01" required>
                    <input type="date" id="meta-data" placeholder="Data Alvo">
                    <button class="btn btn-success" onclick="addGoal()"><i class="fas fa-plus"></i> Adicionar</button>
                </div>
                <div class="form-row">
                    <input type="number" id="meta-poupado" placeholder="Valor Poupa√ß√£o (R$)" step="0.01">
                    <select id="meta-prioridade">
                        <option value="">Prioridade</option>
                        <option value="Alta">Alta</option>
                        <option value="M√©dia">M√©dia</option>
                        <option value="Baixa">Baixa</option>
                    </select>
                    <input type="text" id="meta-observacao" placeholder="Observa√ß√£o (opcional)">
                </div>
            </div>

            <div class="table-container">
                <table id="metas-table">
                    <thead>
                        <tr>
                            <th>Meta</th>
                            <th>Valor Alvo</th>
                            <th>Valor Poupa√ß√£o</th>
                            <th>Progresso</th>
                            <th>Data Alvo</th>
                            <th>Prioridade</th>
                            <th>A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody id="metas-tbody">
                        <!-- Dados ser√£o inseridos via JavaScript -->
                    </tbody>
                </table>
            </div>
            
            <div id="metas-empty" class="empty-state" style="display: none;">
                <i class="fas fa-bullseye"></i>
                <p>Nenhuma meta financeira cadastrada</p>
                <button class="btn btn-outline" onclick="document.getElementById('meta-nome').focus()">
                    <i class="fas fa-plus"></i> Adicionar sua primeira meta
                </button>
            </div>
        </div>

        <!-- P√ÅGINA DE INVESTIMENTOS -->
        <div id="investimentos" class="page">
            <h2><i class="fas fa-chart-pie"></i> Investimentos</h2>
            
            <div class="add-expense">
                <h3>Adicionar Investimento</h3>
                <div class="form-row">
                    <input type="date" id="inv-data" value="">
                    <select id="inv-tipo" required>
                        <option value="">Tipo de Investimento</option>
                        <option value="A√ß√µes">A√ß√µes</option>
                        <option value="FII">Fundo Imobili√°rio</option>
                        <option value="ETF">ETF</option>
                        <option value="Renda Fixa">Renda Fixa</option>
                        <option value="Criptomoedas">Criptomoedas</option>
                        <option value="Internacional">Investimento Internacional</option>
                    </select>
                    <input type="text" id="inv-ticker" placeholder="C√≥digo (ex: PETR4, BOVA11)">
                    <button class="btn btn-success" onclick="addInvestment()"><i class="fas fa-plus"></i> Adicionar</button>
                </div>
                <div class="form-row">
                    <input type="number" id="inv-valor" placeholder="Valor Investido (R$)" step="0.01" required>
                    <input type="number" id="inv-quantidade" placeholder="Quantidade" step="0.01">
                    <select id="inv-pais">
                        <option value="BR">Brasil</option>
                        <option value="US">Estados Unidos</option>
                        <option value="EU">Europa</option>
                        <option value="AS">√Åsia</option>
                        <option value="OT">Outros</option>
                    </select>
                    <input type="number" id="inv-rentabilidade" placeholder="Rentabilidade (% a.a)" step="0.01">
                </div>
                <div class="form-row">
                    <input type="text" id="inv-corretora" placeholder="Corretora/Plataforma">
                    <input type="text" id="inv-setor" placeholder="Setor (ex: Tecnologia)">
                    <input type="text" id="inv-observacao" placeholder="Observa√ß√µes">
                </div>
            </div>

            <div class="table-container">
                <table id="investimentos-table">
                    <thead>
                        <tr>
                            <th>Data</th>
                            <th>Tipo</th>
                            <th>C√≥digo</th>
                            <th>Valor (R$)</th>
                            <th>Pa√≠s</th>
                            <th>Rentabilidade</th>
                            <th>A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody id="investimentos-tbody">
                        <!-- Dados ser√£o inseridos via JavaScript -->
                    </tbody>
                </table>
            </div>
            
            <div id="investimentos-empty" class="empty-state" style="display: none;">
                <i class="fas fa-chart-pie"></i>
                <p>Nenhum investimento cadastrado</p>
                <button class="btn btn-outline" onclick="document.getElementById('inv-ticker').focus()">
                    <i class="fas fa-plus"></i> Adicionar seu primeiro investimento
                </button>
            </div>
            
            <div style="margin-top: 20px;">
                <div class="form-row">
                    <select id="filtro-pais" onchange="filterInvestments()">
                        <option value="">Filtrar por pa√≠s</option>
                        <option value="BR">Brasil</option>
                        <option value="US">Estados Unidos</option>
                        <option value="EU">Europa</option>
                        <option value="AS">√Åsia</option>
                    </select>
                    
                    <select id="filtro-tipo" onchange="filterInvestments()">
                        <option value="">Filtrar por tipo</option>
                        <option value="A√ß√µes">A√ß√µes</option>
                        <option value="FII">Fundo Imobili√°rio</option>
                        <option value="ETF">ETF</option>
                        <option value="Renda Fixa">Renda Fixa</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- P√ÅGINA DE ALERTAS -->
        <div id="alertas" class="page">
            <h2><i class="fas fa-bell"></i> Alertas Financeiros</h2>
            
            <div class="email-alerts">
                <h3><i class="fas fa-envelope"></i> Configura√ß√µes de E-mail</h3>
                <div class="form-row">
                    <div class="input-group">
                        <label for="alert-email">E-mail para alertas</label>
                        <input type="email" id="alert-email" placeholder="seu@email.com">
                    </div>
                    <div class="input-group">
                        <label for="alert-frequency">Frequ√™ncia</label>
                        <select id="alert-frequency">
                            <option value="diario">Di√°rio</option>
                            <option value="semanal" selected>Semanal</option>
                            <option value="mensal">Mensal</option>
                        </select>
                    </div>
                </div>
                <button class="btn btn-primary" onclick="saveAlertSettings()">
                    <i class="fas fa-save"></i> Salvar Configura√ß√µes
                </button>
            </div>

            <div class="alert-settings">
                <div class="alert-setting">
                    <h3><i class="fas fa-exclamation-triangle"></i> Alertas de Gastos</h3>
                    <div class="form-row">
                        <div class="input-group">
                            <label for="alert-gastos">Limite de gastos mensais</label>
                            <input type="number" id="alert-gastos" placeholder="R$ 0,00" step="0.01">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="input-group">
                            <input type="checkbox" id="alert-gastos-ativo" checked>
                            <label for="alert-gastos-ativo">Ativar alerta</label>
                        </div>
                    </div>
                </div>

                <div class="alert-setting">
                    <h3><i class="fas fa-bullseye"></i> Alertas de Metas</h3>
                    <div class="form-row">
                        <div class="input-group">
                            <label for="alert-metas">Dias para lembrete de metas</label>
                            <input type="number" id="alert-metas" placeholder="7" min="1">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="input-group">
                            <input type="checkbox" id="alert-metas-ativo" checked>
                            <label for="alert-metas-ativo">Ativar alerta</label>
                        </div>
                    </div>
                </div>

                <div class="alert-setting">
                    <h3><i class="fas fa-chart-line"></i> Alertas de Investimentos</h3>
                    <div class="form-row">
                        <div class="input-group">
                            <label for="alert-investimentos">Varia√ß√£o percentual</label>
                            <input type="number" id="alert-investimentos" placeholder="5%" step="0.1">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="input-group">
                            <input type="checkbox" id="alert-investimentos-ativo">
                            <label for="alert-investimentos-ativo">Ativar alerta</label>
                        </div>
                    </div>
                </div>
            </div>

            <div class="table-container" style="margin-top: 20px;">
                <table>
                    <thead>
                        <tr>
                            <th>Data</th>
                            <th>Tipo</th>
                            <th>Mensagem</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody id="alertas-tbody">
                        <tr>
                            <td>15/11/2023</td>
                            <td>Gastos</td>
                            <td>Voc√™ atingiu 80% do seu limite mensal de gastos</td>
                            <td><span class="status-badge status-em-andamento">Enviado</span></td>
                        </tr>
                        <tr>
                            <td>01/11/2023</td>
                            <td>Meta</td>
                            <td>Faltam 30 dias para o prazo da meta "Reserva de Emerg√™ncia"</td>
                            <td><span class="status-badge status-concluido">Lido</span></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/js/all.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdn.sheetjs.com/xlsx-0.19.3/package/dist/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script>
        // Dados da aplica√ß√£o
        let financialData = {
            renda: {
                principal: 0,
                extra: 0
            },
            despesasFixas: [
                { categoria: "Aluguel", valor: 1200, tipo: "Moradia", observacao: "Apartamento centro" },
                { categoria: "Condom√≠nio", valor: 500, tipo: "Moradia", observacao: "" },
                { categoria: "Energia El√©trica", valor: 150, tipo: "Moradia", observacao: "M√©dia mensal" },
                { categoria: "Plano de Sa√∫de", valor: 600, tipo: "Sa√∫de", observacao: "Fam√≠lia" }
            ],
            metas: [
                { nome: "Reserva Emerg√™ncia", valorAlvo: 10000, valorPoupado: 2300, dataAlvo: "2024-12-31", prioridade: "Alta" },
                { nome: "Viagem Europa", valorAlvo: 15000, valorPoupado: 5000, dataAlvo: "2025-06-30", prioridade: "M√©dia" }
            ],
            investimentos: [
                { data: "2023-11-01", tipo: "A√ß√µes", ticker: "PETR4", valor: 5000, quantidade: 100, pais: "BR", rentabilidade: 12.5, corretora: "XP Investimentos" },
                { data: "2023-10-15", tipo: "FII", ticker: "MXRF11", valor: 3000, quantidade: 50, pais: "BR", rentabilidade: 8.2, corretora: "Rico" }
            ],
            alertas: {
                email: "",
                frequency: "semanal",
                gastos: {
                    ativo: true,
                    limite: 0
                },
                metas: {
                    ativo: true,
                    diasLembrete: 7
                },
                investimentos: {
                    ativo: false,
                    variacaoPercentual: 5
                }
            },
            historico: {
                meses: [
                    { mes: "Jan/2023", renda: 4000, despesas: 3200, investimentos: 800 },
                    { mes: "Fev/2023", renda: 4200, despesas: 3100, investimentos: 1100 },
                    { mes: "Mar/2023", renda: 4500, despesas: 3500, investimentos: 1000 },
                    { mes: "Abr/2023", renda: 4300, despesas: 3300, investimentos: 1000 },
                    { mes: "Mai/2023", renda: 4600, despesas: 3400, investimentos: 1200 },
                    { mes: "Jun/2023", renda: 4700, despesas: 3600, investimentos: 1100 },
                    { mes: "Jul/2023", renda: 4800, despesas: 3700, investimentos: 1100 },
                    { mes: "Ago/2023", renda: 4900, despesas: 3800, investimentos: 1100 },
                    { mes: "Set/2023", renda: 5000, despesas: 3900, investimentos: 1100 },
                    { mes: "Out/2023", renda: 5100, despesas: 4000, investimentos: 1100 },
                    { mes: "Nov/2023", renda: 5200, despesas: 4100, investimentos: 1100 },
                    { mes: "Dez/2023", renda: 5300, despesas: 4200, investimentos: 1100 }
                ]
            }
        };

        // Dicas financeiras
        const dicasFinanceiras = [
            "Economize pelo menos 10% da sua renda mensal",
            "Revise suas despesas fixas trimestralmente",
            "Diversifique seus investimentos para reduzir riscos",
            "Priorize o pagamento de d√≠vidas com juros altos",
            "Crie uma reserva de emerg√™ncia com 6 meses de despesas",
            "Invista em educa√ß√£o financeira continuamente",
            "Automatize seus investimentos para garantir disciplina",
            "Compare pre√ßos antes de fazer compras grandes",
            "Evite compras por impulso - espere 24 horas",
            "Negocie melhores condi√ß√µes com seus fornecedores"
        ];

        // Dados de usu√°rio
        const users = [
            { email: "edirocha@avivasp.com.br", password: "33071260", name: "Fam√≠lia Barabba Rocha" }
        ];

        // Vari√°veis para gr√°ficos
        let gastosChart, metasChart, alocacaoChart, evolucaoChart, investimentosChart;

        // Fun√ß√£o para mostrar p√°ginas
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.getElementById(pageId).classList.add('active');
            event.target.classList.add('active');
            
            // Atualiza a p√°gina espec√≠fica
            switch(pageId) {
                case 'dashboard':
                    updateDashboard();
                    break;
                case 'fixas':
                    updateFixedExpensesTable();
                    break;
                case 'metas':
                    updateGoalsTable();
                    break;
                case 'investimentos':
                    updateInvestmentsTable();
                    break;
                case 'alertas':
                    loadAlertSettings();
                    break;
            }
        }

        // Fun√ß√£o para inicializar gr√°ficos
        function initCharts() {
            // Gr√°fico de distribui√ß√£o de gastos
            const gastosCtx = document.getElementById('gastosChart').getContext('2d');
            gastosChart = new Chart(gastosCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Moradia', 'Alimenta√ß√£o', 'Transporte', 'Sa√∫de', 'Educa√ß√£o', 'Lazer', 'Outros'],
                    datasets: [{
                        data: [0, 0, 0, 0, 0, 0, 0],
                        backgroundColor: [
                            'rgba(108, 99, 255, 0.7)',
                            'rgba(28, 200, 238, 0.7)',
                            'rgba(255, 79, 193, 0.7)',
                            'rgba(0, 196, 159, 0.7)',
                            'rgba(255, 179, 71, 0.7)',
                            'rgba(100, 116, 139, 0.7)',
                            'rgba(220, 38, 38, 0.7)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right',
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    label += 'R$ ' + context.raw.toFixed(2);
                                    label += ' (' + context.parsed + '%)';
                                    return label;
                                }
                            }
                        }
                    }
                }
            });

            // Gr√°fico de progresso das metas
            const metasCtx = document.getElementById('metasChart').getContext('2d');
            metasChart = new Chart(metasCtx, {
                type: 'bar',
                data: {
                    labels: [],
                    datasets: [{
                        label: 'Valor Alvo',
                        data: [],
                        backgroundColor: 'rgba(108, 99, 255, 0.7)',
                        borderWidth: 1
                    }, {
                        label: 'Valor Poupa√ß√£o',
                        data: [],
                        backgroundColor: 'rgba(28, 200, 238, 0.7)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            stacked: false,
                        },
                        y: {
                            stacked: false,
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return 'R$ ' + value.toLocaleString();
                                }
                            }
                        }
                    },
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    label += 'R$ ' + context.raw.toFixed(2);
                                    return label;
                                }
                            }
                        }
                    }
                }
            });

            // Gr√°fico de evolu√ß√£o financeira
            const evolucaoCtx = document.getElementById('evolucaoChart').getContext('2d');
            evolucaoChart = new Chart(evolucaoCtx, {
                type: 'line',
                data: {
                    labels: [],
                    datasets: [
                        {
                            label: 'Renda',
                            data: [],
                            borderColor: 'rgba(108, 99, 255, 1)',
                            backgroundColor: 'rgba(108, 99, 255, 0.1)',
                            borderWidth: 2,
                            tension: 0.3,
                            fill: true
                        },
                        {
                            label: 'Despesas',
                            data: [],
                            borderColor: 'rgba(255, 79, 193, 1)',
                            backgroundColor: 'rgba(255, 79, 193, 0.1)',
                            borderWidth: 2,
                            tension: 0.3,
                            fill: true
                        },
                        {
                            label: 'Investimentos',
                            data: [],
                            borderColor: 'rgba(0, 196, 159, 1)',
                            backgroundColor: 'rgba(0, 196, 159, 0.1)',
                            borderWidth: 2,
                            tension: 0.3,
                            fill: true
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return 'R$ ' + value.toLocaleString();
                                }
                            }
                        }
                    },
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    label += 'R$ ' + context.raw.toFixed(2);
                                    return label;
                                }
                            }
                        }
                    }
                }
            });

            // Gr√°fico de aloca√ß√£o por pa√≠s
            const alocacaoCtx = document.getElementById('alocacaoChart').getContext('2d');
            alocacaoChart = new Chart(alocacaoCtx, {
                type: 'pie',
                data: {
                    labels: ['Brasil', 'EUA', 'Europa', '√Åsia', 'Outros'],
                    datasets: [{
                        data: [0, 0, 0, 0, 0],
                        backgroundColor: [
                            'rgba(108, 99, 255, 0.7)',
                            'rgba(28, 200, 238, 0.7)',
                            'rgba(255, 79, 193, 0.7)',
                            'rgba(0, 196, 159, 0.7)',
                            'rgba(255, 179, 71, 0.7)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right',
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    label += 'R$ ' + context.raw.toFixed(2);
                                    label += ' (' + context.parsed + '%)';
                                    return label;
                                }
                            }
                        }
                    }
                }
            });

            // Gr√°fico de tipos de investimento
            const investimentosCtx = document.getElementById('investimentosChart').getContext('2d');
            investimentosChart = new Chart(investimentosCtx, {
                type: 'bar',
                data: {
                    labels: ['A√ß√µes', 'FIIs', 'ETFs', 'Renda Fixa', 'Cripto', 'Internacional'],
                    datasets: [{
                        label: 'Valor Investido',
                        data: [0, 0, 0, 0, 0, 0],
                        backgroundColor: [
                            'rgba(108, 99, 255, 0.7)',
                            'rgba(28, 200, 238, 0.7)',
                            'rgba(255, 79, 193, 0.7)',
                            'rgba(0, 196, 159, 0.7)',
                            'rgba(255, 179, 71, 0.7)',
                            'rgba(100, 116, 139, 0.7)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return 'R$ ' + value.toLocaleString();
                                }
                            }
                        }
                    },
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    label += 'R$ ' + context.raw.toFixed(2);
                                    return label;
                                }
                            }
                        }
                    }
                }
            });

            // Configura eventos para os bot√µes de per√≠odo
            document.querySelectorAll('[data-period]').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('[data-period]').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    updateCharts();
                });
            });
        }

        // Fun√ß√£o para atualizar gr√°ficos
        function updateCharts() {
            // Atualiza gr√°fico de distribui√ß√£o de gastos
            const despesasPorTipo = {
                'Moradia': 0,
                'Alimenta√ß√£o': 0,
                'Transporte': 0,
                'Sa√∫de': 0,
                'Educa√ß√£o': 0,
                'Lazer': 0,
                'Outros': 0
            };
            
            financialData.despesasFixas.forEach(item => {
                const tipo = item.tipo || 'Outros';
                if (despesasPorTipo.hasOwnProperty(tipo)) {
                    despesasPorTipo[tipo] += item.valor;
                } else {
                    despesasPorTipo['Outros'] += item.valor;
                }
            });
            
            gastosChart.data.datasets[0].data = [
                despesasPorTipo['Moradia'],
                despesasPorTipo['Alimenta√ß√£o'],
                despesasPorTipo['Transporte'],
                despesasPorTipo['Sa√∫de'],
                despesasPorTipo['Educa√ß√£o'],
                despesasPorTipo['Lazer'],
                despesasPorTipo['Outros']
            ];
            gastosChart.update();

            // Atualiza gr√°fico de metas
            metasChart.data.labels = financialData.metas.map(meta => meta.nome);
            metasChart.data.datasets[0].data = financialData.metas.map(meta => meta.valorAlvo);
            metasChart.data.datasets[1].data = financialData.metas.map(meta => meta.valorPoupado);
            metasChart.update();

            // Atualiza gr√°fico de evolu√ß√£o financeira
            const periodoSelecionado = parseInt(document.querySelector('[data-period].active').dataset.period) || 6;
            const mesesExibir = financialData.historico.meses.slice(-periodoSelecionado);
            
            evolucaoChart.data.labels = mesesExibir.map(item => item.mes);
            evolucaoChart.data.datasets[0].data = mesesExibir.map(item => item.renda);
            evolucaoChart.data.datasets[1].data = mesesExibir.map(item => item.despesas);
            evolucaoChart.data.datasets[2].data = mesesExibir.map(item => item.investimentos);
            evolucaoChart.update();

            // Atualiza gr√°fico de aloca√ß√£o por pa√≠s
            const alocacaoPorPais = {
                'BR': 0,
                'US': 0,
                'EU': 0,
                'AS': 0,
                'OT': 0
            };
            
            financialData.investimentos.forEach(inv => {
                alocacaoPorPais[inv.pais] += inv.valor;
            });
            
            alocacaoChart.data.datasets[0].data = [
                alocacaoPorPais['BR'],
                alocacaoPorPais['US'],
                alocacaoPorPais['EU'],
                alocacaoPorPais['AS'],
                alocacaoPorPais['OT']
            ];
            alocacaoChart.update();

            // Atualiza gr√°fico de tipos de investimento
            const investimentosPorTipo = {
                'A√ß√µes': 0,
                'FII': 0,
                'ETF': 0,
                'Renda Fixa': 0,
                'Criptomoedas': 0,
                'Internacional': 0
            };
            
            financialData.investimentos.forEach(inv => {
                if (investimentosPorTipo.hasOwnProperty(inv.tipo)) {
                    investimentosPorTipo[inv.tipo] += inv.valor;
                }
            });
            
            investimentosChart.data.datasets[0].data = [
                investimentosPorTipo['A√ß√µes'],
                investimentosPorTipo['FII'],
                investimentosPorTipo['ETF'],
                investimentosPorTipo['Renda Fixa'],
                investimentosPorTipo['Criptomoedas'],
                investimentosPorTipo['Internacional']
            ];
            investimentosChart.update();
        }

        // Fun√ß√£o para mostrar uma dica financeira aleat√≥ria
        function mostrarDicaAleatoria() {
            const dicaAleatoria = dicasFinanceiras[Math.floor(Math.random() * dicasFinanceiras.length)];
            document.getElementById('dica-do-dia').textContent = dicaAleatoria;
        }

        function mostrarOutraDica() {
            mostrarDicaAleatoria();
            return false;
        }

        // Fun√ß√£o para salvar dados da p√°gina de preenchimento
        function saveData() {
            // Salva renda
            financialData.renda.principal = parseFloat(document.getElementById('renda-principal').value) || 0;
            financialData.renda.extra = parseFloat(document.getElementById('renda-extra').value) || 0;
            
            // Salva despesas fixas b√°sicas
            financialData.despesasFixas = financialData.despesasFixas.filter(df => 
                !['Aluguel/Moradia', 'Alimenta√ß√£o', 'Transporte', 'Educa√ß√£o'].includes(df.categoria)
            );
            
            const aluguel = parseFloat(document.getElementById('despesa-aluguel').value) || 0;
            if (aluguel > 0) {
                financialData.despesasFixas.push({
                    categoria: "Aluguel/Moradia",
                    valor: aluguel,
                    tipo: "Moradia",
                    observacao: ""
                });
            }
            
            const alimentacao = parseFloat(document.getElementById('despesa-alimentacao').value) || 0;
            if (alimentacao > 0) {
                financialData.despesasFixas.push({
                    categoria: "Alimenta√ß√£o",
                    valor: alimentacao,
                    tipo: "Alimenta√ß√£o",
                    observacao: ""
                });
            }
            
            const transporte = parseFloat(document.getElementById('despesa-transporte').value) || 0;
            if (transporte > 0) {
                financialData.despesasFixas.push({
                    categoria: "Transporte",
                    valor: transporte,
                    tipo: "Transporte",
                    observacao: ""
                });
            }
            
            const educacao = parseFloat(document.getElementById('despesa-educacao').value) || 0;
            if (educacao > 0) {
                financialData.despesasFixas.push({
                    categoria: "Educa√ß√£o",
                    valor: educacao,
                    tipo: "Educa√ß√£o",
                    observacao: ""
                });
            }
            
            // Salva metas b√°sicas
            const reserva = parseFloat(document.getElementById('meta-reserva').value) || 0;
            if (reserva > 0) {
                const metaExistente = financialData.metas.find(m => m.nome === "Reserva de Emerg√™ncia");
                if (metaExistente) {
                    metaExistente.valorAlvo = reserva;
                } else {
                    financialData.metas.push({
                        nome: "Reserva de Emerg√™ncia",
                        valorAlvo: reserva,
                        valorPoupado: 0,
                        dataAlvo: new Date(new Date().setFullYear(new Date().getFullYear() + 1)).toISOString().split('T')[0],
                        prioridade: "Alta"
                    });
                }
            }
            
            const viagem = parseFloat(document.getElementById('meta-viagem').value) || 0;
            if (viagem > 0) {
                const metaExistente = financialData.metas.find(m => m.nome === "Viagem");
                if (metaExistente) {
                    metaExistente.valorAlvo = viagem;
                } else {
                    financialData.metas.push({
                        nome: "Viagem",
                        valorAlvo: viagem,
                        valorPoupado: 0,
                        dataAlvo: new Date(new Date().setFullYear(new Date().getFullYear() + 1)).toISOString().split('T')[0],
                        prioridade: "M√©dia"
                    });
                }
            }
            
            const outraMetaNome = document.getElementById('meta-outra-nome').value;
            const outraMetaValor = parseFloat(document.getElementById('meta-outra-valor').value) || 0;
            if (outraMetaNome && outraMetaValor > 0) {
                financialData.metas.push({
                    nome: outraMetaNome,
                    valorAlvo: outraMetaValor,
                    valorPoupado: 0,
                    dataAlvo: new Date(new Date().setFullYear(new Date().getFullYear() + 1)).toISOString().split('T')[0],
                    prioridade: "Baixa"
                });
            }
            
            // Atualiza o dashboard e mostra mensagem
            updateDashboard();
            alert('Dados b√°sicos salvos com sucesso!');
            
            // Volta para o dashboard
            showPage('dashboard');
        }

        // Fun√ß√µes para despesas fixas
        function addFixedExpense() {
            const categoria = document.getElementById('fixa-categoria').value;
            const valor = parseFloat(document.getElementById('fixa-valor').value) || 0;
            const tipo = document.getElementById('fixa-tipo').value;
            const observacao = document.getElementById('fixa-observacao').value;
            
            if (categoria && valor > 0) {
                financialData.despesasFixas.push({
                    categoria: categoria,
                    valor: valor,
                    tipo: tipo || "Outros",
                    observacao: observacao
                });
                
                // Limpa o formul√°rio
                document.getElementById('fixa-categoria').value = '';
                document.getElementById('fixa-valor').value = '';
                document.getElementById('fixa-tipo').value = '';
                document.getElementById('fixa-observacao').value = '';
                
                // Atualiza a tabela
                updateFixedExpensesTable();
            } else {
                alert("Por favor, preencha pelo menos a categoria e o valor.");
            }
        }

        function removeFixedExpense(index) {
            if (confirm('Tem certeza que deseja remover esta despesa fixa?')) {
                financialData.despesasFixas.splice(index, 1);
                updateFixedExpensesTable();
            }
        }

        function editFixedExpense(index) {
            const expense = financialData.despesasFixas[index];
            const newCategoria = prompt("Editar categoria:", expense.categoria);
            const newValor = prompt("Editar valor:", expense.valor);
            const newTipo = prompt("Editar tipo:", expense.tipo);
            const newObs = prompt("Editar observa√ß√£o:", expense.observacao);
            
            if (newCategoria !== null && newValor !== null) {
                financialData.despesasFixas[index] = {
                    categoria: newCategoria || expense.categoria,
                    valor: parseFloat(newValor) || expense.valor,
                    tipo: newTipo || expense.tipo,
                    observacao: newObs || expense.observacao
                };
                updateFixedExpensesTable();
            }
        }

        function updateFixedExpensesTable() {
            const tbody = document.getElementById('despesas-fixas-tbody');
            tbody.innerHTML = '';
            
            if (financialData.despesasFixas.length === 0) {
                document.getElementById('fixas-empty').style.display = 'block';
                document.getElementById('despesas-fixas-table').style.display = 'none';
                return;
            } else {
                document.getElementById('fixas-empty').style.display = 'none';
                document.getElementById('despesas-fixas-table').style.display = 'table';
            }
            
            let total = 0;
            financialData.despesasFixas.forEach((item, index) => {
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${item.categoria}</td>
                    <td>${item.tipo}</td>
                    <td>R$ ${item.valor.toFixed(2)}</td>
                    <td>${item.observacao || '-'}</td>
                    <td class="actions-cell">
                        <button class="btn btn-outline btn-sm" onclick="editFixedExpense(${index})">
                            <i class="fas fa-edit"></i> Editar
                        </button>
                        <button class="btn btn-danger btn-sm" onclick="removeFixedExpense(${index})">
                            <i class="fas fa-trash-alt"></i> Remover
                        </button>
                    </td>
                `;
                total += item.valor;
            });
            
            const totalRow = tbody.insertRow();
            totalRow.className = 'total-row';
            totalRow.innerHTML = `
                <td colspan="2"><strong>TOTAL FIXO</strong></td>
                <td><strong>R$ ${total.toFixed(2)}</strong></td>
                <td colspan="2"></td>
            `;
            
            // Atualiza o dashboard
            updateDashboard();
        }

        // Fun√ß√µes para metas
        function addGoal() {
            const nome = document.getElementById('meta-nome').value;
            const valorAlvo = parseFloat(document.getElementById('meta-valor').value) || 0;
            const dataAlvo = document.getElementById('meta-data').value;
            const valorPoupado = parseFloat(document.getElementById('meta-poupado').value) || 0;
            const prioridade = document.getElementById('meta-prioridade').value;
            const observacao = document.getElementById('meta-observacao').value;
            
            if (nome && valorAlvo > 0) {
                financialData.metas.push({
                    nome: nome,
                    valorAlvo: valorAlvo,
                    valorPoupado: valorPoupado,
                    dataAlvo: dataAlvo || new Date(new Date().setFullYear(new Date().getFullYear() + 1)).toISOString().split('T')[0],
                    prioridade: prioridade || "M√©dia",
                    observacao: observacao
                });
                
                // Limpa o formul√°rio
                document.getElementById('meta-nome').value = '';
                document.getElementById('meta-valor').value = '';
                document.getElementById('meta-data').value = '';
                document.getElementById('meta-poupado').value = '';
                document.getElementById('meta-prioridade').value = '';
                document.getElementById('meta-observacao').value = '';
                
                // Atualiza a tabela
                updateGoalsTable();
            } else {
                alert("Por favor, preencha pelo menos o nome e o valor alvo da meta.");
            }
        }

        function removeGoal(index) {
            if (confirm('Tem certeza que deseja remover esta meta?')) {
                financialData.metas.splice(index, 1);
                updateGoalsTable();
            }
        }

        function editGoal(index) {
            const meta = financialData.metas[index];
            const novoValorPoupado = parseFloat(prompt(`Editar valor poupado para "${meta.nome}"`, meta.valorPoupado)) || 0;
            
            if (novoValorPoupado !== null) {
                financialData.metas[index].valorPoupado = novoValorPoupado;
                updateGoalsTable();
            }
        }

        function updateGoalsTable() {
            const tbody = document.getElementById('metas-tbody');
            tbody.innerHTML = '';
            
            if (financialData.metas.length === 0) {
                document.getElementById('metas-empty').style.display = 'block';
                document.getElementById('metas-table').style.display = 'none';
                return;
            } else {
                document.getElementById('metas-empty').style.display = 'none';
                document.getElementById('metas-table').style.display = 'table';
            }
            
            financialData.metas.forEach((meta, index) => {
                const percentual = (meta.valorPoupado / meta.valorAlvo) * 100;
                const hoje = new Date();
                const dataAlvo = new Date(meta.dataAlvo);
                const mesesRestantes = Math.max(1, Math.ceil((dataAlvo - hoje) / (1000 * 60 * 60 * 24 * 30)));
                const mensalSugerido = (meta.valorAlvo - meta.valorPoupado) / mesesRestantes;
                
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${meta.nome}</td>
                    <td>R$ ${meta.valorAlvo.toFixed(2)}</td>
                    <td>R$ ${meta.valorPoupado.toFixed(2)}</td>
                    <td>
                        ${percentual.toFixed(1)}%
                        <div class="goal-progress">
                            <div class="goal-progress-bar" style="width: ${Math.min(percentual, 100)}%"></div>
                        </div>
                    </td>
                    <td>${new Date(meta.dataAlvo).toLocaleDateString('pt-BR')}</td>
                    <td>${meta.prioridade}</td>
                    <td class="actions-cell">
                        <button class="btn btn-outline btn-sm" onclick="editGoal(${index})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-danger btn-sm" onclick="removeGoal(${index})">
                            <i class="fas fa-trash-alt"></i>
                        </button>
                    </td>
                `;
            });
            
            // Atualiza o dashboard
            updateDashboard();
        }

        // Fun√ß√µes para investimentos
        function addInvestment() {
            const data = document.getElementById('inv-data').value;
            const tipo = document.getElementById('inv-tipo').value;
            const ticker = document.getElementById('inv-ticker').value;
            const valor = parseFloat(document.getElementById('inv-valor').value) || 0;
            const quantidade = parseFloat(document.getElementById('inv-quantidade').value) || 0;
            const pais = document.getElementById('inv-pais').value;
            const rentabilidade = parseFloat(document.getElementById('inv-rentabilidade').value) || 0;
            const corretora = document.getElementById('inv-corretora').value;
            const setor = document.getElementById('inv-setor').value;
            const observacao = document.getElementById('inv-observacao').value;
            
            if (data && tipo && ticker && valor > 0) {
                financialData.investimentos.push({
                    data: data,
                    tipo: tipo,
                    ticker: ticker,
                    valor: valor,
                    quantidade: quantidade,
                    pais: pais,
                    rentabilidade: rentabilidade,
                    corretora: corretora,
                    setor: setor,
                    observacao: observacao
                });
                
                // Limpa o formul√°rio
                document.getElementById('inv-data').value = '';
                document.getElementById('inv-tipo').value = '';
                document.getElementById('inv-ticker').value = '';
                document.getElementById('inv-valor').value = '';
                document.getElementById('inv-quantidade').value = '';
                document.getElementById('inv-rentabilidade').value = '';
                document.getElementById('inv-corretora').value = '';
                document.getElementById('inv-setor').value = '';
                document.getElementById('inv-observacao').value = '';
                
                // Atualiza a tabela
                updateInvestmentsTable();
            } else {
                alert("Por favor, preencha pelo menos a data, tipo, c√≥digo e valor.");
            }
        }

        function removeInvestment(index) {
            if (confirm('Tem certeza que deseja remover este investimento?')) {
                financialData.investimentos.splice(index, 1);
                updateInvestmentsTable();
            }
        }

        function editInvestment(index) {
            const inv = financialData.investimentos[index];
            const novoValor = parseFloat(prompt(`Editar valor investido para ${inv.ticker}`, inv.valor)) || 0;
            
            if (novoValor !== null) {
                financialData.investimentos[index].valor = novoValor;
                updateInvestmentsTable();
            }
        }

        function filterInvestments() {
            const pais = document.getElementById('filtro-pais').value;
            const tipo = document.getElementById('filtro-tipo').value;
            
            updateInvestmentsTable(pais, tipo);
        }

        function updateInvestmentsTable(paisFilter = '', tipoFilter = '') {
            const tbody = document.getElementById('investimentos-tbody');
            tbody.innerHTML = '';
            
            let investimentosFiltrados = financialData.investimentos;
            
            if (paisFilter) {
                investimentosFiltrados = investimentosFiltrados.filter(inv => inv.pais === paisFilter);
            }
            
            if (tipoFilter) {
                investimentosFiltrados = investimentosFiltrados.filter(inv => inv.tipo === tipoFilter);
            }
            
            if (investimentosFiltrados.length === 0) {
                document.getElementById('investimentos-empty').style.display = 'block';
                document.getElementById('investimentos-table').style.display = 'none';
                return;
            } else {
                document.getElementById('investimentos-empty').style.display = 'none';
                document.getElementById('investimentos-table').style.display = 'table';
            }
            
            let totalInvestido = 0;
            investimentosFiltrados.forEach((inv, index) => {
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${new Date(inv.data).toLocaleDateString('pt-BR')}</td>
                    <td>${inv.tipo}</td>
                    <td>${inv.ticker}</td>
                    <td>R$ ${inv.valor.toFixed(2)}</td>
                    <td>${getCountryName(inv.pais)}</td>
                    <td>${inv.rentabilidade ? inv.rentabilidade.toFixed(2) + '%' : '-'}</td>
                    <td class="actions-cell">
                        <button class="btn btn-outline btn-sm" onclick="editInvestment(${index})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-danger btn-sm" onclick="removeInvestment(${index})">
                            <i class="fas fa-trash-alt"></i>
                        </button>
                    </td>
                `;
                totalInvestido += inv.valor;
            });
            
            const totalRow = tbody.insertRow();
            totalRow.className = 'total-row';
            totalRow.innerHTML = `
                <td colspan="3"><strong>TOTAL INVESTIDO</strong></td>
                <td><strong>R$ ${totalInvestido.toFixed(2)}</strong></td>
                <td colspan="3"></td>
            `;
            
            // Atualiza o dashboard
            updateDashboard();
        }

        function getCountryName(code) {
            const countries = {
                'BR': 'Brasil',
                'US': 'EUA',
                'EU': 'Europa',
                'AS': '√Åsia',
                'OT': 'Outros'
            };
            return countries[code] || code;
        }

        // Fun√ß√µes para alertas
        function loadAlertSettings() {
            document.getElementById('alert-email').value = financialData.alertas.email;
            document.getElementById('alert-frequency').value = financialData.alertas.frequency;
            
            document.getElementById('alert-gastos').value = financialData.alertas.gastos.limite;
            document.getElementById('alert-gastos-ativo').checked = financialData.alertas.gastos.ativo;
            
            document.getElementById('alert-metas').value = financialData.alertas.metas.diasLembrete;
            document.getElementById('alert-metas-ativo').checked = financialData.alertas.metas.ativo;
            
            document.getElementById('alert-investimentos').value = financialData.alertas.investimentos.variacaoPercentual;
            document.getElementById('alert-investimentos-ativo').checked = financialData.alertas.investimentos.ativo;
        }

        function saveAlertSettings() {
            financialData.alertas.email = document.getElementById('alert-email').value;
            financialData.alertas.frequency = document.getElementById('alert-frequency').value;
            
            financialData.alertas.gastos.limite = parseFloat(document.getElementById('alert-gastos').value) || 0;
            financialData.alertas.gastos.ativo = document.getElementById('alert-gastos-ativo').checked;
            
            financialData.alertas.metas.diasLembrete = parseInt(document.getElementById('alert-metas').value) || 7;
            financialData.alertas.metas.ativo = document.getElementById('alert-metas-ativo').checked;
            
            financialData.alertas.investimentos.variacaoPercentual = parseFloat(document.getElementById('alert-investimentos').value) || 5;
            financialData.alertas.investimentos.ativo = document.getElementById('alert-investimentos-ativo').checked;
            
            alert('Configura√ß√µes de alertas salvas com sucesso!');
        }

        // Fun√ß√µes para exporta√ß√£o
        function exportToPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // T√≠tulo
            doc.setFontSize(18);
            doc.text('Relat√≥rio Financeiro - Fam√≠lia Barabba Rocha', 105, 20, { align: 'center' });
            
            // Data
            doc.setFontSize(12);
            doc.text(`Gerado em: ${new Date().toLocaleDateString('pt-BR')}`, 105, 30, { align: 'center' });
            
            // Resumo Financeiro
            doc.setFontSize(14);
            doc.text('Resumo Financeiro', 20, 45);
            doc.setFontSize(12);
            
            const rendaTotal = financialData.renda.principal + financialData.renda.extra;
            const despesasFixasTotal = financialData.despesasFixas.reduce((total, item) => total + item.valor, 0);
            const saldo = rendaTotal - despesasFixasTotal;
            
            doc.text(`Renda Mensal: R$ ${rendaTotal.toFixed(2)}`, 20, 55);
            doc.text(`Despesas Fixas: R$ ${despesasFixasTotal.toFixed(2)}`, 20, 65);
            doc.text(`Saldo Dispon√≠vel: R$ ${saldo.toFixed(2)}`, 20, 75);
            
            // Metas
            doc.setFontSize(14);
            doc.text('Metas Financeiras', 20, 95);
            doc.setFontSize(12);
            
            let yPosition = 105;
            financialData.metas.forEach((meta, index) => {
                if (yPosition > 250) {
                    doc.addPage();
                    yPosition = 20;
                }
                
                const percentual = (meta.valorPoupado / meta.valorAlvo) * 100;
                doc.text(`${meta.nome}: ${percentual.toFixed(1)}% (R$ ${meta.valorPoupado.toFixed(2)} de R$ ${meta.valorAlvo.toFixed(2)})`, 20, yPosition);
                yPosition += 10;
            });
            
            // Investimentos
            doc.setFontSize(14);
            doc.text('Investimentos', 20, yPosition + 10);
            doc.setFontSize(12);
            yPosition += 20;
            
            financialData.investimentos.forEach((inv, index) => {
                if (yPosition > 250) {
                    doc.addPage();
                    yPosition = 20;
                }
                
                doc.text(`${inv.ticker} (${inv.tipo}): R$ ${inv.valor.toFixed(2)} - ${getCountryName(inv.pais)}`, 20, yPosition);
                yPosition += 10;
            });
            
            doc.save('relatorio-financeiro-barabba-rocha.pdf');
        }

        function exportToExcel() {
            // Cria uma nova workbook
            const wb = XLSX.utils.book_new();
            
            // Adiciona planilha de resumo
            const resumoData = [
                ['Categoria', 'Valor (R$)'],
                ['Renda Total', financialData.renda.principal + financialData.renda.extra],
                ['Despesas Fixas', financialData.despesasFixas.reduce((total, item) => total + item.valor, 0)],
                ['Saldo Dispon√≠vel', (financialData.renda.principal + financialData.renda.extra) - financialData.despesasFixas.reduce((total, item) => total + item.valor, 0)]
            ];
            
            const resumoWS = XLSX.utils.aoa_to_sheet(resumoData);
            XLSX.utils.book_append_sheet(wb, resumoWS, "Resumo");
            
            // Adiciona planilha de metas
            const metasData = [
                ['Meta', 'Valor Alvo (R$)', 'Valor Poupa√ß√£o (R$)', '% Conclu√≠do', 'Data Alvo', 'Prioridade']
            ];
            
            financialData.metas.forEach(meta => {
                metasData.push([
                    meta.nome,
                    meta.valorAlvo,
                    meta.valorPoupado,
                    (meta.valorPoupado / meta.valorAlvo) * 100,
                    new Date(meta.dataAlvo).toLocaleDateString('pt-BR'),
                    meta.prioridade
                ]);
            });
            
            const metasWS = XLSX.utils.aoa_to_sheet(metasData);
            XLSX.utils.book_append_sheet(wb, metasWS, "Metas");
            
            // Adiciona planilha de investimentos
            const investimentosData = [
                ['Data', 'Tipo', 'C√≥digo', 'Valor (R$)', 'Pa√≠s', 'Rentabilidade (%)', 'Corretora']
            ];
            
            financialData.investimentos.forEach(inv => {
                investimentosData.push([
                    new Date(inv.data).toLocaleDateString('pt-BR'),
                    inv.tipo,
                    inv.ticker,
                    inv.valor,
                    getCountryName(inv.pais),
                    inv.rentabilidade,
                    inv.corretora
                ]);
            });
            
            const investimentosWS = XLSX.utils.aoa_to_sheet(investimentosData);
            XLSX.utils.book_append_sheet(wb, investimentosWS, "Investimentos");
            
            // Exporta o arquivo
            XLSX.writeFile(wb, 'relatorio-financeiro-barabba-rocha.xlsx');
        }

        // Fun√ß√£o para atualizar o dashboard
        function updateDashboard() {
            // Atualiza renda
            const rendaTotal = financialData.renda.principal + financialData.renda.extra;
            document.getElementById('renda-mensal').textContent = rendaTotal.toFixed(2);
            document.getElementById('renda-principal-valor').textContent = 'R$ ' + financialData.renda.principal.toFixed(2);
            document.getElementById('renda-extra-valor').textContent = 'R$ ' + financialData.renda.extra.toFixed(2);
            
            // Atualiza despesas fixas
            const despesasFixasTotal = financialData.despesasFixas.reduce((total, item) => total + item.valor, 0);
            document.getElementById('despesas-fixas-total').textContent = despesasFixasTotal.toFixed(2);
            document.getElementById('despesas-categorias').textContent = financialData.despesasFixas.length;
            
            // Atualiza reserva financeira
            const reservaMeta = financialData.metas.find(m => m.nome === "Reserva de Emerg√™ncia") || { valorPoupado: 0, valorAlvo: 1 };
            document.getElementById('reserva-total').textContent = reservaMeta.valorPoupado.toFixed(2);
            const mesesSeguranca = Math.floor(reservaMeta.valorPoupado / (despesasFixasTotal || 1));
            document.getElementById('reserva-meses').textContent = mesesSeguranca;
            
            // Atualiza investimentos
            const investimentosTotal = financialData.investimentos.reduce((total, item) => total + item.valor, 0);
            document.getElementById('patrimonio-total').textContent = (rendaTotal + investimentosTotal).toFixed(2);
            document.getElementById('patrimonio-investimentos').textContent = 'R$ ' + investimentosTotal.toFixed(2);
            
            // Atualiza saldo
            const saldo = rendaTotal - despesasFixasTotal;
            const saldoElement = document.getElementById('saldo-mensal');
            saldoElement.textContent = `R$ ${saldo.toFixed(2)}`;
            
            const saldoStatusElement = document.getElementById('saldo-status').querySelector('span');
            if (saldo < 0) {
                saldoElement.style.color = 'var(--danger-color)';
                saldoStatusElement.textContent = 'Cr√≠tico';
                saldoStatusElement.style.color = 'var(--danger-color)';
            } else if (saldo < rendaTotal * 0.1) {
                saldoElement.style.color = 'var(--warning-color)';
                saldoStatusElement.textContent = 'Aten√ß√£o';
                saldoStatusElement.style.color = 'var(--warning-color)';
            } else {
                saldoElement.style.color = 'var(--success-color)';
                saldoStatusElement.textContent = 'Saud√°vel';
                saldoStatusElement.style.color = 'var(--success-color)';
            }
            
            // Atualiza alertas e pr√≥ximas despesas
            document.getElementById('alertas-pendentes').textContent = '2'; // Simulado
            document.getElementById('proximas-despesas').textContent = financialData.despesasFixas.length > 0 ? 'R$ ' + financialData.despesasFixas[0].valor.toFixed(2) : 'Nenhuma';
            
            // Mostra dica aleat√≥ria
            mostrarDicaAleatoria();
            
            // Atualiza gr√°ficos
            updateCharts();
        }

        // Fun√ß√£o para enviar alertas por e-mail (simulado)
        function sendEmailAlerts() {
            if (!financialData.alertas.email) return;
            
            // Verifica alerta de gastos
            if (financialData.alertas.gastos.ativo) {
                const despesasFixasTotal = financialData.despesasFixas.reduce((total, item) => total + item.valor, 0);
                const rendaTotal = financialData.renda.principal + financialData.renda.extra;
                const percentualGastos = (despesasFixasTotal / rendaTotal) * 100;
                
                if (percentualGastos > 80) {
                    const alerta = {
                        data: new Date().toISOString().split('T')[0],
                        tipo: 'Gastos',
                        mensagem: `Voc√™ atingiu ${Math.round(percentualGastos)}% do seu limite mensal de gastos`,
                        status: 'Pendente'
                    };
                    // Aqui voc√™ adicionaria o alerta √† lista de alertas
                }
            }
            
            // Verifica alerta de metas
            if (financialData.alertas.metas.ativo) {
                financialData.metas.forEach(meta => {
                    const hoje = new Date();
                    const dataAlvo = new Date(meta.dataAlvo);
                    const diasRestantes = Math.ceil((dataAlvo - hoje) / (1000 * 60 * 60 * 24));
                    
                    if (diasRestantes <= financialData.alertas.metas.diasLembrete) {
                        const alerta = {
                            data: new Date().toISOString().split('T')[0],
                            tipo: 'Meta',
                            mensagem: `Faltam ${diasRestantes} dias para o prazo da meta "${meta.nome}"`,
                            status: 'Pendente'
                        };
                        // Aqui voc√™ adicionaria o alerta √† lista de alertas
                    }
                });
            }
        }

        // Fun√ß√£o de Login
        function login() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            const user = users.find(u => u.email === email && u.password === password);
            
            if (user) {
                document.getElementById('loginPage').style.display = 'none';
                document.getElementById('appContainer').style.display = 'block';
                document.getElementById('userName').textContent = user.name;
                
                // Efeito de confete para login bem-sucedido
                showConfetti();
                
                // Inicializa o sistema financeiro
                initFinanceSystem();
            } else {
                // Feedback visual para erro de login
                const loginCard = document.querySelector('.login-card');
                loginCard.style.animation = 'shake 0.5s';
                setTimeout(() => {
                    loginCard.style.animation = '';
                }, 500);
                
                alert('Credenciais inv√°lidas. Por favor, tente novamente.');
            }
        }

        function showConfetti() {
            // Implementa√ß√£o simples de confete
            const colors = ['#6C63FF', '#1CC8EE', '#FF4FC1', '#00C49F'];
            for (let i = 0; i < 50; i++) {
                const confetti = document.createElement('div');
                confetti.style.position = 'fixed';
                confetti.style.width = '10px';
                confetti.style.height = '10px';
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.borderRadius = '50%';
                confetti.style.left = Math.random() * 100 + 'vw';
                confetti.style.top = '-10px';
                confetti.style.zIndex = '9999';
                confetti.style.transform = 'rotate(' + Math.random() * 360 + 'deg)';
                
                document.body.appendChild(confetti);
                
                const animation = confetti.animate([
                    { top: '-10px', opacity: 1 },
                    { top: '100vh', opacity: 0 }
                ], {
                    duration: 1000 + Math.random() * 2000,
                    easing: 'cubic-bezier(0.1, 0.8, 0.9, 1)'
                });
                
                animation.onfinish = () => confetti.remove();
            }
        }

        function showForgotPassword() {
            alert("Por seguran√ßa, entre em contato com o administrador do sistema para redefinir sua senha.");
        }

        // Carrega dados salvos do localStorage
        function loadSavedData() {
            const savedData = localStorage.getItem('financialDataBarabbaRocha');
            if (savedData) {
                financialData = JSON.parse(savedData);
            }
        }

        // Salva dados no localStorage
        function saveDataToStorage() {
            localStorage.setItem('financialDataBarabbaRocha', JSON.stringify(financialData));
        }

        // Configura listeners para salvar dados quando houver mudan√ßas
        function setupEventListeners() {
            window.addEventListener('beforeunload', saveDataToStorage);
        }

        // Inicializa o sistema financeiro
        function initFinanceSystem() {
            // Carrega dados salvos
            loadSavedData();
            
            // Inicializa gr√°ficos
            initCharts();
            
            // Atualiza o dashboard
            updateDashboard();
            
            // Configura listeners
            setupEventListeners();
            
            // Mostra alertas pendentes
            sendEmailAlerts();
        }

        // Anima√ß√£o de shake para erros de login
        const style = document.createElement('style');
        style.textContent = `
            @keyframes shake {
                0%, 100% { transform: translateX(0); }
                10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
                20%, 40%, 60%, 80% { transform: translateX(5px); }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>